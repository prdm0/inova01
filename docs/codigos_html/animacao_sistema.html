<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA para Licenciamento Ambiental - Simulação</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* slate-100 */
        }

        .component-card {
            background: white;
            border: 1px solid #e2e8f0; /* slate-200 */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes pulse-core {
            0%, 100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.4); }
            50% { box-shadow: 0 0 0 12px rgba(37, 99, 235, 0); }
        }
        .pulse-animation {
            animation: pulse-core 2s infinite;
        }

        .active-glow {
            transform: translateY(-4px);
            border-color: #2563eb; /* blue-600 */
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1), 0 0 0 3px rgba(59, 130, 246, 0.3);
        }

        .data-packet {
            position: absolute;
            width: 16px;
            height: 16px;
            background-color: #60a5fa; /* blue-400 */
            border-radius: 50%;
            z-index: 50;
            opacity: 0;
            transition: left 1.2s cubic-bezier(0.5, 0, 0.5, 1),
                        top 1.2s cubic-bezier(0.5, 0, 0.5, 1),
                        opacity 0.3s ease-in-out;
            animation: packet-glow 1.2s ease-in-out infinite;
        }

        @keyframes packet-glow {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 8px 2px #3b82f6;
            }
            50% {
                transform: scale(1.8);
                box-shadow: 0 0 25px 8px rgba(96, 165, 250, 0.8);
            }
        }

        .line {
            position: absolute;
            background-color: #cbd5e1; /* slate-300 */
            z-index: -1;
        }
    </style>
</head>
<body class="text-slate-900 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-7xl p-6 bg-white rounded-2xl shadow-lg">
        <!-- Cabeçalho --><div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-2xl font-bold text-blue-700">Simulação de IA para Licenciamento Ambiental</h1>
                <p id="status-text" class="text-slate-500 mt-1 h-6 transition-opacity duration-300">Inspirado no projeto da UFPB para a Sudema.</p>
            </div>
            <button id="start-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-5 rounded-lg transition-all duration-300 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                Analisar Projeto
            </button>
        </div>

        <!-- Container da Simulação --><div id="simulation-container" class="relative w-full h-[600px] bg-slate-50 rounded-lg p-8">

            <!-- Componentes --><div id="entrada" class="component-card absolute top-1/2 -translate-y-1/2 left-8 w-48 h-28 flex flex-col items-center justify-center rounded-lg p-2">
                <svg class="h-8 w-8 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                <h3 class="font-semibold mt-1">1. Entrada de Dados</h3>
                <p class="text-xs text-slate-400 text-center">Info do projeto</p>
            </div>

            <div id="core" class="component-card absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 w-48 h-48 flex flex-col items-center justify-center rounded-full p-4 pulse-animation">
                <svg class="h-12 w-12 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                <h3 class="font-bold text-lg mt-2">Núcleo de IA</h3>
                <p id="core-status" class="text-xs text-slate-500">Aguardando...</p>
            </div>

            <div id="base-legal" class="absolute top-8 left-1/2 -translate-x-1/2 flex gap-4">
                <div id="luos" class="component-card w-40 h-24 flex flex-col items-center justify-center rounded-lg p-2">
                    <svg class="h-7 w-7 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path></svg>
                    <h3 class="font-semibold mt-1">Base Legal: LUOS</h3>
                </div>
                <div id="na101" class="component-card w-40 h-24 flex flex-col items-center justify-center rounded-lg p-2">
                     <svg class="h-7 w-7 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path></svg>
                    <h3 class="font-semibold mt-1">Base Legal: NA-101</h3>
                </div>
            </div>

            <div id="inferencia" class="component-card absolute top-1/2 -translate-y-1/2 right-8 w-48 h-28 flex flex-col items-center justify-center rounded-lg p-2">
                <!-- Ícone de Rede Neural para Motor de Inferência --><svg class="h-8 w-8 text-purple-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="18" cy="5" r="3"></circle>
                    <circle cx="6" cy="12" r="3"></circle>
                    <circle cx="18" cy="19" r="3"></circle>
                    <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                    <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                </svg>
                <h3 class="font-semibold mt-1">2. Motor de Inferência</h3>
                <p class="text-xs text-slate-400 text-center">Modelos Preditivos</p>
            </div>

            <div id="analise-calculo" class="absolute bottom-8 left-1/2 -translate-x-1/2 flex gap-4">
                <div id="risco" class="component-card w-40 h-24 flex flex-col items-center justify-center rounded-lg p-2">
                    <!-- Ícone de Análise de Risco (Alerta mais claro) --><svg class="h-7 w-7 text-red-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                        <line x1="12" y1="9" x2="12" y2="13"></line>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                    <h3 class="font-semibold mt-1">Análise de Risco</h3>
                </div>
                <div id="calculos" class="component-card w-40 h-24 flex flex-col items-center justify-center rounded-lg p-2">
                    <svg class="h-7 w-7 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                    <h3 class="font-semibold mt-1">Cálculos Auto.</h3>
                </div>
            </div>

            <div id="resultado" class="absolute inset-x-8 bottom-8 h-24 component-card rounded-lg p-4 flex items-center justify-center opacity-0 transition-opacity duration-500">
                <h2 id="resultado-texto" class="text-xl font-bold text-center"></h2>
            </div>
        </div>
    </div>

<script>
    const startBtn = document.getElementById('start-btn');
    const statusText = document.getElementById('status-text');
    const coreStatus = document.getElementById('core-status');
    const container = document.getElementById('simulation-container');
    const resultadoDiv = document.getElementById('resultado');
    const resultadoTexto = document.getElementById('resultado-texto');

    const components = {
        entrada: document.getElementById('entrada'),
        core: document.getElementById('core'),
        luos: document.getElementById('luos'),
        na101: document.getElementById('na101'),
        inferencia: document.getElementById('inferencia'),
        risco: document.getElementById('risco'),
        calculos: document.getElementById('calculos'),
    };

    function getCenterPosition(element) {
        const rect = element.getBoundingClientRect();
        const containerRect = container.getBoundingClientRect();
        return {
            x: rect.left - containerRect.left + rect.width / 2,
            y: rect.top - containerRect.top + rect.height / 2,
        };
    }

    function animatePacket(startEl, endEl, delay = 0) {
        return new Promise(resolve => {
            setTimeout(() => {
                const packet = document.createElement('div');
                packet.className = 'data-packet';
                container.appendChild(packet);
                const startPos = getCenterPosition(startEl);
                const endPos = getCenterPosition(endEl);
                packet.style.left = `${startPos.x - 8}px`; // Ajuste para o novo tamanho da bolinha
                packet.style.top = `${startPos.y - 8}px`;  // Ajuste para o novo tamanho da bolinha
                requestAnimationFrame(() => {
                    packet.style.opacity = '1';
                    packet.style.left = `${endPos.x - 8}px`; // Ajuste para o novo tamanho da bolinha
                    packet.style.top = `${endPos.y - 8}px`;  // Ajuste para o novo tamanho da bolinha
                });
                setTimeout(() => {
                    packet.style.opacity = '0';
                    setTimeout(() => {
                        if (container.contains(packet)) {
                            container.removeChild(packet)
                        }
                    }, 300);
                    resolve();
                }, 1200);
            }, delay);
        });
    }

    function updateStatus(text, coreText = '') {
        statusText.style.opacity = '0';
        setTimeout(() => {
            statusText.textContent = text;
            if (coreText) coreStatus.textContent = coreText;
            statusText.style.opacity = '1';
        }, 300);
    }

    function resetState() {
        Object.values(components).forEach(el => el.classList.remove('active-glow'));
        resultadoDiv.style.opacity = '0';
        resultadoDiv.classList.remove('bg-green-100', 'border-green-400', 'bg-red-100', 'border-red-400');
        resultadoTexto.classList.remove('text-green-800', 'text-red-800');
        components.core.classList.add('pulse-animation');
        updateStatus('Pronto para iniciar nova análise de projeto.', 'Aguardando...');
    }

    async function startSimulation() {
        startBtn.disabled = true;
        resetState();

        // 1. Entrada -> Core
        updateStatus('Recebendo dados do projeto...', 'Iniciando...');
        components.entrada.classList.add('active-glow');
        await animatePacket(components.entrada, components.core);
        components.entrada.classList.remove('active-glow');
        components.core.classList.add('active-glow');

        // 2. Core -> Base Legal -> Core
        updateStatus('Analisando conformidade com a legislação...', 'Consultando Leis');
        await Promise.all([
            animatePacket(components.core, components.luos),
            animatePacket(components.core, components.na101)
        ]);
        components.luos.classList.add('active-glow');
        components.na101.classList.add('active-glow');
        await new Promise(r => setTimeout(r, 1500));
        updateStatus('Interpretando artigos relevantes...', 'Processando...');
        await Promise.all([
            animatePacket(components.luos, components.core),
            animatePacket(components.na101, components.core)
        ]);
        components.luos.classList.remove('active-glow');
        components.na101.classList.remove('active-glow');

        // 3. Core -> Inferência
        updateStatus('Aplicando modelos preditivos...', 'Inferência ML/LLM');
        await animatePacket(components.core, components.inferencia);
        components.inferencia.classList.add('active-glow');
        await new Promise(r => setTimeout(r, 1500));

        // 4. Inferência -> Risco e Cálculos
        updateStatus('Calculando índices e avaliando riscos ambientais...', 'Análise de Risco');
        await Promise.all([
            animatePacket(components.inferencia, components.risco),
            animatePacket(components.inferencia, components.calculos)
        ]);
        components.risco.classList.add('active-glow');
        components.calculos.classList.add('active-glow');
        components.inferencia.classList.remove('active-glow');
        await new Promise(r => setTimeout(r, 1500));

        // 5. Risco e Cálculos -> Core
        updateStatus('Consolidando análise e gerando parecer técnico...', 'Gerando Parecer');
        await Promise.all([
            animatePacket(components.risco, components.core),
            animatePacket(components.calculos, components.core)
        ]);
        components.risco.classList.remove('active-glow');
        components.calculos.classList.remove('active-glow');
        await new Promise(r => setTimeout(r, 1000));

        // 6. Resultado Final
        components.core.classList.remove('active-glow', 'pulse-animation');
        resultadoDiv.style.opacity = '1';
        const isApproved = Math.random() > 0.4; // 60% chance
        if (isApproved) {
            resultadoTexto.textContent = 'PARECER FINAL: Licença Aprovada. O projeto atende aos critérios da LUOS e NA-101.';
            resultadoDiv.classList.add('bg-green-100', 'border-green-400');
            resultadoTexto.classList.add('text-green-800');
            updateStatus('Análise concluída com sucesso!', 'Aprovado');
        } else {
            resultadoTexto.textContent = "PARECER FINAL: Licença Negada. Risco ambiental elevado devido à sobreposição com APP (Art. 12 da LUOS).";
            resultadoDiv.classList.add('bg-red-100', 'border-red-400');
            resultadoTexto.classList.add('text-red-800');
            updateStatus('Análise concluída. Foram encontradas não conformidades.', 'Negado');
        }

        startBtn.disabled = false;
    }

    startBtn.addEventListener('click', startSimulation);
</script>
</body>
</html>

